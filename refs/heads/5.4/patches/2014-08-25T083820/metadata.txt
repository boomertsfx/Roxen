subject: Roxen 5.4: htaccess, DB Backup, Static Resource
from: 550f76b70c381fe79dd7ed19cb0531c305bc10a5
to: dbb6b88e10658c458094b60df67c4c6825968409
originator: wellhardh@roxen.com
depends: 2014-08-13T100518
restart: true

Multiple fixes:

  * Fixed request trace nesting inconsistency.

  * Perform negative caching of (typically) htaccess files for 5 seconds.
    
    This avoids trying to stat the same files over and over in a single request.
    Also added a 60 second timeout for positively cached files.

  * DBManager: Updated mysqldump invocation to mysql 4.0 and later.
    
    The mysqldump option "--all" apparently changed name to
    "--create-options" some time after mysql 3.23.
    
    Fixes database backups with current versions of mysqldump.
    
    Fixes some of [bug 6126].

  * DBManager: Backup system fixes.
    
    Don't attempt to use the old MySQL BACKUP and RESTORE commands with
    MySQL 5.5 or later.
    
    The automatic backup scheduler will now use the "mysqldump" method
    for any databases where the "backup" method is selected, when the
    internal MySQL server is version 5.5 or later.
    
    Note that it is not possible to restore old backups made with the
    BACKUP command with MySQL 5.5 or later. Any such backups should
    be replaced with backups made with the mysqldump method prior to
    upgrading the MySQL server.
    
    Fixes some of [bug 6126], cf also [bug 7088].

  * Static Resource: Don't crash on empty src attrs. Fixes [bug 7243].

  * RoxenPatch: Run patch in binary mode on WIN32.
    
    The patch binary on WIN32 defaults to breaking the linefeeds in patches
    for files that use CRLF as EOL. Fix it by always opening the files in
    binary mode.
    
    Fixes [bug 7244].
